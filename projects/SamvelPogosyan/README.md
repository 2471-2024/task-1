я исправил и переделал код. Должно все работать
